# 🎬 DB5785 - פרויקט מערכת נתונים לשירות סטרימינג 🗄️

מערכת ניהול מסד נתונים מקיפה לפלטפורמת שירות סטרימינג, הבנויה עם PostgreSQL ו-Docker, הכוללת פרופילי משתמשים מרובים, ניהול תכנים, עיבוד תשלומים וניתוח צפיות.

---

## 📋 תוכן עניינים

- [סקירת הפרויקט](#סקירת-הפרויקט)
- [שלב א - עיצוב בסיס הנתונים ואכלוס](#שלב-א---עיצוב-בסיס-הנתונים-ואכלוס)
- [שלב ב - שאילתות ואילוצים](#שלב-ב---שאילתות-ואילוצים)
- [שלב ג - אינטגרציה ומבטים](#שלב-ג---אינטגרציה-ומבטים)
- [שלב ד - תכנות בסיס נתונים מתקדם](#שלב-ד---תכנות-בסיס-נתונים-מתקדם)
- [שלב ה - ממשק גרפי](#שלב-ה---ממשק-גרפי)
- [הוראות התקנה](#הוראות-התקנה)
- [מבנה הפרויקט](#מבנה-הפרויקט)

---

## 🎯 סקירת הפרויקט

### מטרת הפרויקט
פרויקט זה מיישם מערכת מסד נתונים מלאה לפלטפורמת שירות סטרימינג דומה לנטפליקס. המטרה העיקרית היא ליצור מערכת יעילה ומותאמת לצרכים הייחודיים של שירותי סטרימינג מודרניים.

### למה בחרנו בנושא הזה?
שירותי הסטרימינג מהווים חלק מרכזי מהתרבות הדיגיטלית המודרנית ומציבים אתגרים מרתקים:
- **ניהול נתונים מרובי משתמשים** - משפחות עם פרופילים שונים
- **עקיבה אחר התנהגות צפייה** - לצורך המלצות והתאמה אישית
- **ניהול תשלומים מתקדם** - מנויים, חיובים וניהול כספי
- **אבטחת מידע** - הגנה על פרטיות המשתמשים

### התכונות המרכזיות
- **חשבונות לקוחות מרובי פרופילים** - בני משפחה יכולים להיות בעלי פרופילי צפייה נפרדים לשמירת פרטיות והתאמה אישית
- **ניהול מכשירים** - מעקב אחר מכשירי צפייה מרובים לכל לקוח לצורך בקרת גישה ואבטחה
- **עיבוד תשלומים** - חיוב מנויים והיסטוריית תשלומים לניהול פיננסי יעיל
- **מעקב תכנים** - היסטוריית צפייה, מועדפים ודירוגים לשיפור חוויית המשתמש
- **תמיכה בניתוחים** - שאילתות מורכבות לאינטליגנציה עסקית ותובנות על דפוסי צפייה

---

## 📊 שלב א - עיצוב בסיס הנתונים ואכלוס

### מטרת השלב
השלב הראשון מתמקד ביצירת בסיס נתונים מנורמל ויעיל שיכול לתמוך בכל הפונקציונליות הנדרשת משירות סטרימינג מודרני. העיצוב חייב להיות גמיש מספיק כדי לאפשר צמיחה עתידית ואופטימיזציה לביצועים.

### עיצוב סכמת בסיס הנתונים

מסד הנתונים של שירות הסטרימינג מורכב מ-8 ישויות מרכזיות המעוצבות לפי נורמליזציה ברמת 3NF:

#### הטבלאות המרכזיות

**1. טבלת Customer - מידע לקוחות מרכזי**
```sql
customerID (INT PRIMARY KEY) - מזהה ייחודי לכל לקוח
firstName (VARCHAR) - שם פרטי של הלקוח
lastName (VARCHAR) - שם משפחה של הלקוח
dateOfBirth (DATE) - לצורך אימות גיל ובקרת הורים
customerSince (DATE) - תאריך יצירת חשבון למעקב נאמנות
```

**למה זה חשוב?**
טבלת הלקוחות מהווה את הלב של המערכת. המידע על תאריך הלידה חיוני לאכיפת הגבלות גיל על תכנים, בעוד שתאריך רישום החשבון מאפשר לנו לזהות לקוחות ותיקים ולהציע להם הטבות מיוחדות.

**2. טבלת Devices - ניהול מכשירי צפייה**
```sql
deviceID (INT PRIMARY KEY) - מזהה ייחודי למכשיר
deviceName (VARCHAR) - שם המכשיר הידידותי למשתמש
deviceType (VARCHAR) - סוג המכשיר (iOS, Android, Smart TV וכו')
lastSeen (DATE) - פעילות אחרונה לצורך מעקב אבטחה
customerID (INT, FOREIGN KEY) - קישור המכשיר ללקוח
```

**למה זה חשוב?**
מעקב אחר מכשירים חיוני למניעת שיתוף חשבונות לא מורשה ולהבטחת איכות השירות. המידע על סוג המכשיר מאפשר אופטימיזציה של איכות הווידאו בהתאם ליכולות המכשיר.

**3. טבלת Profile - פרופילי צפייה מרובים**
```sql
profileID (INT PRIMARY KEY) - מזהה ייחודי לפרופיל
profileName (VARCHAR) - שם התצוגה של הפרופיל
profilePicture (VARCHAR) - נתיב תמונת אווטר
isOnline (BOOL) - סטטוס מקוון נוכחי
WatchHistoryID (INT, FOREIGN KEY) - קישור להיסטוריית צפייה
customerID (INT, FOREIGN KEY) - קישור הפרופיל ללקוח
```

**למה זה חשוב?**
פרופילים מרובים מאפשרים לבני משפחה שונים להנות מחוויית צפייה מותאמת אישית, כולל המלצות נפרדות והגבלות גיל שונות לכל פרופיל.

**4. טבלת WatchHistory - מעקב היסטוריית צפייה**
```sql
WatchHistoryID (INT PRIMARY KEY) - מזהה ייחודי לרשומה
movieID (INT) - התייחסות לתוכן שנצפה
watchDate (DATE) - מתי התוכן נצפה
durationWatched (FLOAT) - דקות צפייה למעקב השלמה
```

**למה זה חשוב?**
היסטוריית הצפייה היא הבסיס למערכת ההמלצות והתאמה אישית. מעקב אחר משך הצפייה מאפשר לזהות תכנים פופולריים ולשפר את האלגוריתמים להמלצות.

**5. טבלת Payment - תשלומים וחיוב מנויים**
```sql
paymentID (INT PRIMARY KEY) - מזהה ייחודי לתשלום
paymentDate (DATE) - מתי התשלום עובד
amount (FLOAT) - סכום התשלום
currency (VARCHAR) - סוג המטבע (USD, EUR, NIS וכו')
paymentMethod (VARCHAR) - אמצעי התשלום שנעשה בו שימוש
status (VARCHAR) - סטטוס התשלום (הושלם, ממתין, נכשל)
customerID (INT, FOREIGN KEY) - קישור התשלום ללקוח
```

**למה זה חשוב?**
ניהול תשלומים מדויק חיוני לקיימות העסק. מעקב אחר סטטוס התשלומים מאפשר זיהוי מהיר של בעיות וטיפול יעיל בהן.

**6. טבלת Favorites - תכנים מועדפים של המשתמש**
```sql
movieID (INT PRIMARY KEY) - מזהה ייחודי לתוכן
lastSeen (DATE) - מתי התוכן סומן כמועדף לאחרונה
totalTimeWatched (FLOAT) - זמן צפייה כולל בתוכן
```

**למה זה חשוב?**
רשימת מועדפים מאפשרת למשתמשים גישה מהירה לתכנים שהם אוהבים ומספקת תובנות על העדפותיהם למערכת ההמלצות.

**7. טבלת Reviews - ביקורות ודירוגי משתמשים**
```sql
movieID (INT PRIMARY KEY) - התוכן המדורג
rating (INT) - דירוג כוכבים (1-5)
comment (VARCHAR) - טקסט הביקורת הכתובה
reviewDate (DATE) - מתי הביקורת נשלחה
profileID (INT, FOREIGN KEY) - קישור הביקורת לפרופיל
```

**למה זה חשוב?**
ביקורות משתמשים מסייעות למשתמשים אחרים לקבל החלטות צפייה מושכלות ומספקות פידבק חשוב לצוות הקמת התכנים.

**8. טבלת MarksAsFavorite - טבלת חיבור לפרופילי מועדפים**
```sql
profileID (INT, FOREIGN KEY) - פרופיל המסמן כמועדף
movieID (INT, FOREIGN KEY) - תוכן המסומן כמועדף
מפתח ראשי מורכב (profileID, movieID)
```

**למה זה חשוב?**
טבלת החיבור מאפשרת לכל פרופיל להחזיק רשימת מועדפים נפרדת, תוך שמירה על יעילות המסד ומניעת כפילויות.

### תרשימי קשרי ישויות

#### ERD (תרשים קשרי ישויות)
![ERD](images/erd/ERD.PNG)

**מה התרשים מראה לנו:**
התרשים מציג את הקשרים הלוגיים בין הישויות השונות במערכת. הקשרים מעוצבים כך שישקפו את המציאות העסקית - לקוח יכול להיות בעל מכשירים רבים, כל פרופיל שייך ללקוח מסוים, וכו'.

#### DSD (תרשים סכמת מסד הנתונים)  
![DSD](images/erd/DSD.png)

**מה התרשים מראה לנו:**
התרשים מתרגם את העיצוב הלוגי לעיצוב פיזי, כולל סוגי נתונים, אילוצים ומפתחות. זהו הבסיס ליצירת הטבלאות בפועל.

### שיטות אכלוס הנתונים

**למה חשוב לאכלס בנתונים?**
בסיס נתונים ריק אינו מאפשר בדיקה אמינה של השאילתות והפונקציונליות. נתונים ריאליסטיים מאפשרים זיהוי בעיות ביצועים ובדיקת התנהגות המערכת בתנאים אמיתיים.

בסיס הנתונים אוכלס באמצעות שלוש גישות שונות:

1. **יצירת סקריפט Python** - [קוד Python ליצירת נתונים](Backups/Backup1%20/generatedata.py)
   
   **למה Python?** Python מאפשר יצירת נתונים מורכבים ומותאמים אישית עם לוגיקה עסקית, כמו וידוא שתאריכי צפייה הגיוניים ביחס לתאריך רישום הלקוח.

2. **הצהרות INSERT ב-SQL** - [קוד SQL ליצירת נתונים](Backups/Backup1%20/generatedata.sql)  
   
   **למה SQL ישיר?** SQL ישיר מאפשר שליטה מלאה על הנתונים הנוצרים ויעיל מאוד לטעינת כמויות גדולות של נתונים.

3. **שירות Mockaroo** - [מחולל תבניות Excel](Backups/Backup1%20/excelTemplateGen.py)
   
   **למה Mockaroo?** הכלי מאפשר יצירת נתונים ריאליסטיים במהירות, כולל שמות אמיתיים, כתובות ותאריכים הגיוניים.

כל טבלה מכילה 400+ רשומות עם נתוני שירות סטרימינג ריאליסטיים.

### קבצי יצירת בסיס הנתונים

- [קובץ SQL ליצירת טבלאות](code/sql/createtable.sql) - סקריפט יצירת הטבלאות
- הליכי גיבוי ושחזור מיושמים ובדוקים

---

## 🔍 שלב ב - שאילתות ואילוצים

### מטרת השלב
השלב השני מתמקד ביצירת שאילתות מורכבות המדמות שימוש אמיתי במערכת, כמו גם הטמעת אילוצים להבטחת איכות הנתונים. המטרה היא להוכיח שהמערכת יכולה לענות על צרכים עסקיים אמיתיים.

### שאילתות SELECT מורכבות

**למה שאילתות מורכבות חשובות?**
שאילתות מורכבות מדמות צרכים עסקיים אמיתיים כמו יצירת דוחות, ניתוח התנהגות משתמשים ויצירת תובנות להחלטות עסקיות.

**1. כל הפרופילים עם היסטוריית צפייה ב-2024, כולל שמות הלקוחות**
![היסטוריית צפייה 2024](images/queries/viewing_history_2024.png)

**מדוע השאילתא הזו חשובה?**
מאפשרת לצוות השיווק לזהות לקוחות פעילים ולהתאים להם קמפיינים מתאימים. כמו כן, עוזרת לזהות פרופילים לא פעילים שאולי זקוקים לעידוד.

**2. זמן צפייה ממוצע בסרטים מועדפים**
![ממוצע מועדפים](images/queries/favorites_avg.png)

**מדוע השאילתא הזו חשובה?**
עוזרת להבין איזה תכנים באמת מעסיקים את המשתמשים לאורך זמן ולא רק זוכים לצפייה חד-פעמית.

**3. פרטי תשלום של לקוחות שמשלמים מעל 200 ש"ח בשנה האחרונה**
![תשלום מעל 200](images/queries/paid_over_200.png)

**מדוע השאילתא הזו חשובה?**
מזהה לקוחות בעלי ערך גבוה שראוי להשקיע בשמירה עליהם ולהציע להם שירותים מתקדמים.

**4. לקוחות עם יותר משני מכשירים רשומים**
![יותר משני מכשירים](images/queries/more_than_two_devices.png)

**מדוע השאילתא הזו חשובה?**
מסייעת בזיהוי אפשרות לשיתוף חשבונות לא מורשה או לקוחות שזקוקים לחבילת מכשירים מורחבת.

**5. רשימת פרופילים שהוסיפו סרט מועדף שדורג פחות מ-3**
![סרט מועדף דירוג נמוך](images/queries/low_rated_fav_movie.png)

**מדוע השאילתא הזו חשובה?**
מגלה אולי בעיות במערכת הדירוגים או טעם ייחודי של משתמשים שכדאי להבין טוב יותר.

**6. כל הסרטים שנצפו באוקטובר כולל משך הצפייה**
![סרטים שנצפו באוקטובר](images/queries/october_watched_movies.png)

**מדוע השאילתא הזו חשובה?**
מאפשרת ניתוח עונתי של דפוסי צפייה ותכנון תכנים מתאימים לחגים ועונות.

**7. פרטי לקוחות שלא ביצעו תשלומים השנה**
![לא קנו](images/queries/did_not_buy.png)

**מדוע השאילתא הזו חשובה?**
מזהה לקוחות בסיכון לעזיבה או שאולי זקוקים לסיוע בתהליך התשלום.

**8. זמני צפייה ממוצעים לפי חודש**
![זמן צפייה ממוצע](images/queries/avg_viewing_time.png)

**מדוע השאילתא הזו חשובה?**
מגלה מגמות עונתיות ומסייעת בתכנון קיבולת שרתים ותכנים מתאימים.

### פעולות שינוי נתונים

#### פעולות DELETE

**למה חשוב למחוק נתונים ישנים?**
מחיקת נתונים ישנים ולא רלוונטיים משפרת ביצועים, חוסכת שטח אחסון ומקפידה על תקנות פרטיות כמו GDPR.

**1. מחיקת פרופילים לא פעילים מעל שנה**
- לפני: ![לפני שנה](images/queries/before_one_year.png)
- אחרי: ![אחרי שנה](images/queries/after_one_years.png)

**מדוע המחיקה הזו הכרחית?**
פרופילים לא פעילים מבזבזים משאבי מערכת ועלולים להוות פרצת אבטחה. מחיקתם משפרת ביצועים ואבטחה.

**2. מחיקת מכשירים שלא נראו מעל שנתיים**
- לפני: ![לפני שנתיים](images/queries/before_two_years.png)
- אחרי: ![אחרי שנתיים](images/queries/after_two_years.png)

**מדוע המחיקה הזו הכרחית?**
מכשירים ישנים עלולים להיות מכשירים שאבדו או נגנבו. מחיקתם מבטיחה שרק מכשירים רלוונטיים יש להם גישה.

**3. מחיקת תשלומים כושלים**
- לפני: ![לפני תשלומים כושלים](images/queries/before_failed_payments_delete.png)
- אחרי: ![אחרי תשלומים כושלים](images/queries/after_failed_payments_delete.png)

**מדוע המחיקה הזו הכרחית?**
תשלומים כושלים ישנים אינם רלוונטיים לניתוח ועלולים לבלבל דוחות כספיים.

#### פעולות UPDATE

**למה חשוב לעדכן נתונים?**
עדכון נתונים מבטיח שהמידע במערכת תמיד עדכני ומדויק, מה שחיוני לקבלת החלטות נכונות.

**1. עדכון סטטוס תשלום ל"הושלם"**
- לפני: ![לפני הושלם](images/queries/before_completed.png)
- אחרי: ![אחרי הושלם](images/queries/after_completed.png)

**מדוע העדכון הזה חשוב?**
תשלומים שהושלמו אבל עדיין מסומנים כ"ממתין" עלולים לגרום לחסימת שירות לא מוצדקת.

**2. הוספת תמונות פרופיל ברירת מחדל למשתמשים ללא תמונה**
- לפני: ![לפני תמונות ברירת מחדל](images/queries/before_default_pictures.png)
- אחרי: ![אחרי תמונות ברירת מחדל](images/queries/after_default_pictures.png)

**מדוע העדכון הזה חשוב?**
תמונות פרופיל משפרות את חוויית המשתמש ומקלות על זיהוי פרופילים שונים במשפחה.

**3. שדרוג ביקורות חיוביות לדירוג 5 כוכבים**
- לפני: ![לפני שדרוג ל-5](images/queries/before_5.png)
- אחרי: ![אחרי שדרוג ל-5](images/queries/after_5.png)

**מדוע העדכון הזה חשוב?**
תיקון דירוגים שגויים משפר את איכות מערכת ההמלצות ונותן ייצוג טוב יותר לתכנים איכותיים.

### בקרת טרנזקציות

#### הדגמת Rollback
**למה Rollback חשוב?**
Rollback מאפשר לבטל שינויים במקרה של שגיאה או בעיה, מה שמבטיח את שלמות הנתונים.

- אמצע Rollback: ![אמצע Rollback](images/queries/before_rollback.png)
- אחרי Rollback: ![אחרי Rollback](images/queries/after_rollback.png)

### אילוצי בסיס הנתונים

**למה אילוצים חשובים?**
אילוצים מבטיחים שהנתונים שנכנסים למערכת הם תקינים ועקביים, ומונעים הכנסת נתונים שגויים שעלולים לפגוע באמינות המערכת.

**1. סכום תשלום לא יכול להיות שלילי**
![סכום חיובי](images/queries/positive_amount.png)

**מדוע האילוץ הזה הכרחי?**
תשלום שלילי הוא מצב לא הגיוני שעלול להצביע על שגיאה במערכת התשלומים.

**2. סטטוס תשלום חייב להיות מרשימה ספציפית**
![סטטוס תשלום פורמלי](images/queries/formal_payment_status.png)

**מדוע האילוץ הזה הכרחי?**
הגבלת סטטוסים לערכים מוגדרים מונעת טעויות הקלדה ומבטיחה עקביות בדיווחים.

**3. כל פרופיל חייב להיות בעל תמונת ברירת מחדל**
![תמונה לא ריקה](images/queries/not_null_picture.png)

**מדוע האילוץ הזה הכרחי?**
תמונת פרופיל היא חלק בסיסי מחוויית המשתמש וחוסר תמונה עלול לגרום לבעיות בממשק.

### קבצי שאילתות
- [שאילתות](part2/Queries.sql) - כל שאילתות ה-SELECT, UPDATE, DELETE
- [אילוצים](part2/Constraints.sql) - הגדרות אילוצי בסיס הנתונים
- [Rollback Commit](part2/RollBackCommit) - דוגמאות בקרת טרנזקציות

---

## 🔗 שלב ג - אינטגרציה ומבטים

### מטרת השלב
שלב זה מתמקד באינטגרציה של שני מערכות נתונים נפרדות - מערכת ניהול התוכן שלנו עם מערכת ניהול יוצרים והפקות. המטרה היא ליצור מערכת אחידה ומקיפה יותר.

### אינטגרציה של מסדי נתונים

**למה אינטגרציה חשובה?**
בעולם האמיתי, חברות מתפתחות דרך רכישות ומיזוגים. היכולת לאחד מערכות נתונים שונות היא מיומנות קריטית. בנוסף, אינטגרציה מאפשרת קבלת תמונה מלאה יותר על העסק.

#### תהליך הנדוס לאחור

קיבלנו גיבוי של מסד נתונים לניהול יוצרים וביצענו הנדוס לאחור להבנת המבנה שלו:

**ERD של המערכת החיצונית**
![ERD חיצוני](images/theirs/their_erd.png)

**DSD של המערכת החיצונית**  
![DSD חיצוני](images/theirs/their_dsd.png)

**מדוע הנדוס לאחור חשוב?**
לעיתים קרובות אנו מקבלים מערכות ללא תיעוד מלא. הנדוס לאחור מאפשר לנו להבין את הלוגיקה העסקית המקורית ולתכנן אינטגרציה נכונה.

#### תהליך האינטגרציה

האינטגרציה התמקדה במיזוג טבלת Production ממערכת היוצרים לתוך טבלת Title הקיימת במערכת שלנו, כדי ליצור ישות מרכזית ואחידה לכלל התכנים.

**למה בחרנו באסטרטגיית המיזוג הזו?**
במקום לשמור שתי טבלאות נפרדות לתכנים, החלטנו לאחד אותן כי:
- מונע כפילות נתונים
- מפשט שאילתות עתידיות
- יוצר מקור אמת יחיד לכל התכנים
- מאפשר ניהול מטא-דטה מרכזי

**ERD המשולב**
![ERD משולב](images/integrated/integrated_erd.png)

**DSD המשולב**
![DSD משולב](images/integrated/integrated_dsd.png)

### מבטים (Views) במסד הנתונים

**למה מבטים חשובים?**
מבטים מאפשרים:
- **הפשטת שאילתות מורכבות** - הפיכת שאילתות מסובכות לפשוטות לשימוש
- **אבטחת מידע** - הגבלת גישה לעמודות או שורות רגישות
- **עקביות** - הבטחה שכל המשתמשים רואים את אותו מידע בצורה זהה
- **ביצועים** - אופטימיזציה של שאילתות נפוצות

**אימות אכלוס מסד הנתונים**
![מסד נתונים מאוכלס](part3/database_populated.png)

**הצלחת שינוי סכמה**
![Alter Table עובד](part3/alterTableWorks.png)

#### מבט 1 - ניתוח תכנים
![מבט 1](part3/viewImages/view1.png)

**מטרת המבט:**
מבט זה מאחד מידע על תכנים עם נתוני צפייה וביקורות, מה שמאפשר למנהלי תכנים לקבל תמונה מלאה על ביצועי התכנים השונים.

**שאילתא 1.1**
![שאילתא 1.1](part3/viewImages/query11.png)

**מדוע השאילתא הזו שימושית?**
מאפשרת זיהוי התכנים הפופולריים ביותר מבחינת זמן צפייה, מה שעוזר בהחלטות על הזמנת תכנים חדשים.

**שאילתא 1.2**
![שאילתא 1.2](part3/viewImages/query12.png)

**מדוע השאילתא הזו שימושית?**
עוזרת לזהות תכנים שמקבלים דירוגים גבוהים אבל זמן צפייה נמוך, מה שיכול להצביע על בעיות טכניות או תוכן לא מתאים.

#### מבט 2 - ניתוח לקוחות
![מבט 2](part3/viewImages/view2.png)

**מטרת המבט:**
מבט זה מרכז מידע על לקוחות, התנהגות הצפייה שלהם ופרטי התשלום, מה שמאפשר לצוות השיווק וה-CRM לנהל לקוחות ביעילות.

**שאילתא 2.1**
![שאילתא 2.1](part3/viewImages/query21.png)

**מדוע השאילתא הזו שימושית?**
מזהה לקוחות עם פעילות צפייה גבוהה שאולי מתאימים לשדרוג לחבילה פרמיום.

**שאילתא 2.2**
![שאילתא 2.2](part3/viewImages/query22.png)

**מדוע השאילתא הזו שימושית?**
עוזרת לזהות לקוחות שעלולים לבטל מנוי (זמן צפייה נמוך למרות תשלום) ולהתערב בזמן.

---

## 💻 שלב ד - תכנות בסיס נתונים מתקדם

### מטרת השלב
שלב זה מתמקד בפיתוח תוכניות מתקדמות במסד הנתונים המממשות לוגיקה עסקית מורכבת. המטרה היא ליצור פונקציות, פרוצדורות וטריגרים שמאפשרים אוטומציה ובקרת איכות של הנתונים.

### תכנות PL/pgSQL

**למה תכנות במסד הנתונים חשוב?**
- **ביצועים** - קוד שרץ קרוב לנתונים מהיר יותר
- **בטיחות** - לוגיקה עסקית במסד מבטיחה עקביות
- **מרכזיות** - חוקים עסקיים במקום אחד
- **אמינות** - טרנזקציות ובקרת שגיאות מתקדמת

פיתחנו תוכניות מסד נתונים מתקדמות הכוללות פונקציות, פרוצדורות, טריגרים ותוכניות ראשיות המממשות פונקציונליות מגוונת לשירות הסטרימינג.

**הצלחת יישום התכנות**
![שלב 4 עובד](part4/part4Works.png)

#### תכונות שיושמו:

**2 פונקציות - עיבוד נתונים וחישובים מורכבים**

**מדוע פונקציות חשובות?**
פונקציות מאפשרות לנו לעטוף לוגיקה עסקית מורכבת בפעולות פשוטות לשימוש. לדוגמה, חישוב ממוצע זמן צפייה ללקוח או זיהוי התכנים הפופולריים ביותר.

**2 פרוצדורות - ניהול נתונים ולוגיקה עסקית**

**מדוע פרוצדורות חשובות?**
פרוצדורות מבצעות פעולות מורכבות שעשויות לכלול מספר שלבים, כמו עדכון מרובה טבלאות או תהליכי ניקוי נתונים.

**2 טריגרים - בדיקת נתונים אוטומטית ולוגים**

**מדוע טריגרים חשובים?**
טריגרים מבטיחים שכל שינוי בנתונים עובר בדיקות איכות אוטומטיות ומתועד למעקב. לדוגמה, טריגר שמבטיח שתאריך צפייה לא יכול להיות לפני תאריך רישום הלקוח.

**2 תוכניות ראשיות - תזמור קריאות לפונקציות ופרוצדורות**

**מדוע תוכניות ראשיות חשובות?**
מאפשרות ביצוע תהליכים מורכבים שמשלבים מספר פונקציות ופרוצדורות, כמו תהליך ניקוי נתונים חודשי או יצירת דוחות מקיפים.

### אלמנטי תכנות שיושמו:
- **Cursors (מפורשים וגלויים)** - לעיבוד נתונים שורה אחר שורה
- **החזרת Ref Cursor** - לשליפת נתונים דינמית
- **פעולות DML (INSERT, UPDATE, DELETE)** - לשינוי נתונים
- **הסתעפויות ולולאות** - ללוגיקה מורכבת
- **טיפול בחריגות (Exception Handling)** - לבטיחות ואמינות
- **סוגי רשומות (Record Types)** - למבנה נתונים יעיל

**למה כל האלמנטים האלה חשובים?**
השילוב של כל האלמנטים מאפשר יצירת תוכניות חזקות ואמינות שיכולות להתמודד עם מצבים מורכבים ושגיאות בצורה אלגנטית.

---

## 🖥️ שלב ה - ממשק גרפי

### מטרת השלב
שלב זה מתמקד ביצירת ממשק משתמש ידידותי ופונקציונלי המאפשר לאנשים ללא ידע טכני לעבוד עם מסד הנתונים בצורה בטוחה ויעילה.

### ממשק האפליקציה

**למה ממשק גרפי חשוב?**
- **נגישות** - אנשים ללא ידע SQL יכולים לעבוד עם המערכת
- **בטיחות** - מונע הרצת פקודות מסוכנות בטעות
- **יעילות** - מאפשר ביצוע פעולות מורכבות בקלות
- **מקצועיות** - נותן למערכת מראה מקצועי ומוגמר

פיתחנו אפליקציית GUI מקיפה לאינטראקציה עם מסד הנתונים באמצעות Python.

#### מערכת כניסה
![כניסה](part5/images/login.png)

**מדוע מערכת כניסה חשובה?**
מבטיחה שרק משתמשים מורשים יכולים לגשת למערכת ולבצע שינויים במסד הנתונים. הדבר חיוני לאבטחת מידע רגיש של לקוחות.

#### ניהול לקוחות
![לקוחות](part5/images/costumers.png)

**מדוע מסך ניהול לקוחות חשוב?**
מאפשר לצוותי שירות לקוחות לראות במבט חטוף את כל הלקוחות, לחפש לקוחות ספציפיים ולגשת למידע שלהם במהירות.

#### הוספת לקוח חדש
![הוספת לקוח](part5/images/add_costumer.png)

**מדוע מסך הוספת לקוח חשוב?**
מבטיח שכל הנתונים הנדרשים נכנסים בצורה נכונה ועקבית, עם בדיקות תקינות שמונעות טעויות.

#### מחיקת לקוח
![מחיקת לקוח](part5/images/delete.png)

**מדוע מסך מחיקה חשוב?**
מבטיח שמחיקות מתבצעות רק לאחר אישור ובצורה מבוקרת, מה שמונע מחיקה בטעות של נתונים חשובים.

#### עריכת פרטי לקוח
![עריכת לקוח](part5/images/edit_costumer.png)

**מדוע מסך עריכה חשוב?**
מאפשר עדכון מידע לקוחות בצורה מבוקרת, תוך שמירה על שלמות הנתונים ומניעת שינויים לא רצויים.

### תכונות הGUI:
- **פעולות CRUD** - יצירה, קריאה, עדכון ומחיקה עבור 3+ טבלאות
- **הרצת שאילתות** - הרצת שאילתות מורכבות משלב ב
- **קריאות לפונקציות/פרוצדורות** - הפעלת תוכניות מסד נתונים משלב ד
- **ממשק ידידותי למשתמש** - ניווט אינטואיטיבי והצגת נתונים ברורה

**למה התכונות האלה חשובות?**
השילוב של כל התכונות יוצר מערכת מקיפה שמאפשרת לעובדי החברה לבצע את כל המשימות הנדרשות ללא צורך בידע טכני מתקדם.

### קבצי האפליקציה:
- אפליקציה ראשית: `streaming_service_gui.py`
- מודולים תומכים וקבצי הגדרות כלולים

---

## 🛠️ הוראות התקנה

### דרישות מוקדמות
- **Docker** - [התקנת Docker](https://docs.docker.com/get-docker/)
- **Docker Compose** (אופציונלי) - [התקנת Docker Compose](https://docs.docker.com/compose/install/)

**למה בחרנו ב-Docker?**
Docker מאפשר הרצת מסד הנתונים בסביבה מבודדת ועקבית, ללא קשר למערכת ההפעלה או להגדרות המחשב.

### הגדרת PostgreSQL

```bash
# הורדת image של PostgreSQL
docker pull postgres:latest

# יצירת volume לשמירת נתונים
docker volume create postgres_data

# הרצת container של PostgreSQL
docker run --name postgres -e POSTGRES_PASSWORD=your_password -d -p 5432:5432 -v postgres_data:/var/lib/postgresql/data postgres
```

### הגדרת pgAdmin

```bash
# הורדת image של pgAdmin
docker pull dpage/pgadmin4:latest

# הרצת container של pgAdmin
docker run --name pgadmin -d -p 5050:80 -e PGADMIN_DEFAULT_EMAIL=admin@example.com -e PGADMIN_DEFAULT_PASSWORD=admin dpage/pgadmin4:latest
```

### חיבור למסד הנתונים

1. גישה ל-pgAdmin בכתובת `http://localhost:5050`
2. חיבור ל-PostgreSQL באמצעות:
   - Host: `postgres` (או מציאת IP עם `docker inspect --format='{{.NetworkSettings.IPAddress}}' postgres`)
   - Port: `5432`
   - Username: `postgres`
   - Password: `your_password`

---

## 📁 מבנה הפרויקט

```
DBProject/
├── images/
│   ├── erd/              # תרשימי ERD ו-DSD
│   ├── queries/          # צילומי מסך של תוצאות שאילתות
│   ├── theirs/           # תרשימי מערכת חיצונית
│   └── integrated/       # תרשימי אינטגרציה
├── code/sql/             # סקריפטי יצירת SQL
├── part2/                # קבצי שלב ב
├── part3/                # קבצי שלב ג  
├── part4/                # קבצי שלב ד
├── part5/                # קבצי GUI שלב ה
├── Backups/              # סקריפטי יצירת נתונים
└── README.md            # קובץ זה
```

---

## 🎯 תוצאות הפרויקט

פרויקט מסד נתונים מקיף זה מדגים:

**עיצוב מסד נתונים** - עיצוב סכמה מנורמלת לפי עקרונות 3NF
**ניהול נתונים** - שאילתות מורכבות, אילוצים ושמירת שלמות נתונים
**אינטגרציה מערכות** - מיזוג מספר מערכות נתונים
**תכנות מתקדם** - פונקציות, פרוצדורות וטריגרים ב-PL/pgSQL
**פיתוח אפליקציות** - GUI מלא לאינטראקציה עם מסד הנתונים
**שיטות DevOps** - deployment מבוסס containers עם Docker

מסד הנתונים של שירות הסטרימינג מדמה בהצלחה תרחישים מהעולם האמיתי ומספק בסיס חזק לפלטפורמת סטרימינג בייצור.

**למה הפרויקט הזה חשוב?**
הפרויקט מדגים את כל השלבים הנדרשים לפיתוח מערכת מסד נתונים מקצועית - מהעיצוב הראשוני ועד למוצר מוגמר עם ממשק משתמש. זהו סימולציה מדויקת של פרויקט אמיתי בתעשייה.

---

## 📚 משאבים

- [תיעוד PostgreSQL](https://www.postgresql.org/docs/)
- [תיעוד pgAdmin](https://www.pgadmin.org/docs/)
- [תיעוד Docker](https://docs.docker.com/)
